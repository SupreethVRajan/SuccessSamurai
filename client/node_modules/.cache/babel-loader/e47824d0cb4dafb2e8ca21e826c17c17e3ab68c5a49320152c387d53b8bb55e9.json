{"ast":null,"code":"var _jsxFileName = \"/home/supreeth/SuccessSamurai/client/src/Context/index.tsx\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst UserContext = /*#__PURE__*/createContext([{\n  data: null,\n  error: null,\n  loading: true\n}, () => {}]);\nconst UserProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [user, setUser] = useState({\n    data: null,\n    error: null,\n    loading: true\n  });\n  const token = localStorage.getItem(\"token\");\n  if (token) {\n    axios.defaults.headers.common[\"authorization\"] = `Bearer ${token}`;\n  }\n  const fetchUser = async () => {\n    const {\n      data: response\n    } = await axios.get(\"http://localhost:5000/auth/me\");\n    if (response.data && response.data.user) {\n      setUser({\n        data: {\n          id: response.data.user.id,\n          email: response.data.user.email\n        },\n        loading: false,\n        error: null\n      });\n    } else if (response.data && response.data.errors.length) {\n      setUser({\n        data: null,\n        loading: false,\n        error: response.errors[0].msg\n      });\n    }\n  };\n  useEffect(() => {\n    if (token) {\n      fetchUser();\n    } else {\n      setUser({\n        data: null,\n        loading: false,\n        error: null\n      });\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: [user, setUser],\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 12\n  }, this);\n};\n_s(UserProvider, \"Z14ZeIoKq/hc+s027Q7xMy1s7xk=\");\n_c = UserProvider;\nexport { UserContext, UserProvider };\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","axios","jsxDEV","_jsxDEV","UserContext","data","error","loading","UserProvider","_ref","_s","children","user","setUser","token","localStorage","getItem","defaults","headers","common","fetchUser","response","get","id","email","errors","length","msg","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/home/supreeth/SuccessSamurai/client/src/Context/index.tsx"],"sourcesContent":["import {createContext, useEffect, useState} from \"react\";\nimport axios from \"axios\";\n\ninterface User {\n    data: {\n        id: string;\n        email: string;\n        stripeCustomerId: string;\n    } | null\n    error: string | null\n    loading: boolean\n}\n\nconst UserContext = createContext<\n    [User, React.Dispatch<React.SetStateAction<User>>]\n> ([\n    {\n        data: null,\n        error: null,\n        loading: true\n    }, () => {}\n])\n\nconst UserProvider = ({children}: any) => {\n    const [user, setUser] = useState<User>({\n        data: null,\n        error: null,\n        loading: true\n    });\n\n    const token = localStorage.getItem(\"token\")\n\n    if (token) {\n        axios.defaults.headers.common[\"authorization\"] = `Bearer ${token}`\n    }\n\n    const fetchUser = async () => {\n        const {data: response} =await axios.get(\"http://localhost:5000/auth/me\");\n\n        if (response.data && response.data.user) {\n            setUser({\n                data: {\n                    id: response.data.user.id,\n                    email: response.data.user.email\n                },\n                loading: false,\n                error: null\n            })\n        }\n        else if(response.data && response.data.errors.length) {\n            setUser({\n                data: null,\n                loading: false,\n                error: response.errors[0].msg\n            })\n        }\n        \n    }\n\n    useEffect(() => {\n        if(token) {\n            fetchUser();\n        }\n        else {\n            setUser({\n                data: null,\n                loading: false,\n                error: null\n            })\n        }\n        \n    }, [])\n\n    return <UserContext.Provider value={[user, setUser]}>\n        {children}\n    </UserContext.Provider>\n};\n\nexport {UserContext, UserProvider};"],"mappings":";;AAAA,SAAQA,aAAa,EAAEC,SAAS,EAAEC,QAAQ,QAAO,OAAO;AACxD,OAAOC,KAAK,MAAM,OAAO;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAY1B,MAAMC,WAAW,gBAAGN,aAAa,CAE9B,CACC;EACIO,IAAI,EAAE,IAAI;EACVC,KAAK,EAAE,IAAI;EACXC,OAAO,EAAE;AACb,CAAC,EAAE,MAAM,CAAC,CAAC,CACd,CAAC;AAEF,MAAMC,YAAY,GAAGC,IAAA,IAAqB;EAAAC,EAAA;EAAA,IAApB;IAACC;EAAa,CAAC,GAAAF,IAAA;EACjC,MAAM,CAACG,IAAI,EAAEC,OAAO,CAAC,GAAGb,QAAQ,CAAO;IACnCK,IAAI,EAAE,IAAI;IACVC,KAAK,EAAE,IAAI;IACXC,OAAO,EAAE;EACb,CAAC,CAAC;EAEF,MAAMO,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAE3C,IAAIF,KAAK,EAAE;IACPb,KAAK,CAACgB,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAI,UAASL,KAAM,EAAC;EACtE;EAEA,MAAMM,SAAS,GAAG,MAAAA,CAAA,KAAY;IAC1B,MAAM;MAACf,IAAI,EAAEgB;IAAQ,CAAC,GAAE,MAAMpB,KAAK,CAACqB,GAAG,CAAC,+BAA+B,CAAC;IAExE,IAAID,QAAQ,CAAChB,IAAI,IAAIgB,QAAQ,CAAChB,IAAI,CAACO,IAAI,EAAE;MACrCC,OAAO,CAAC;QACJR,IAAI,EAAE;UACFkB,EAAE,EAAEF,QAAQ,CAAChB,IAAI,CAACO,IAAI,CAACW,EAAE;UACzBC,KAAK,EAAEH,QAAQ,CAAChB,IAAI,CAACO,IAAI,CAACY;QAC9B,CAAC;QACDjB,OAAO,EAAE,KAAK;QACdD,KAAK,EAAE;MACX,CAAC,CAAC;IACN,CAAC,MACI,IAAGe,QAAQ,CAAChB,IAAI,IAAIgB,QAAQ,CAAChB,IAAI,CAACoB,MAAM,CAACC,MAAM,EAAE;MAClDb,OAAO,CAAC;QACJR,IAAI,EAAE,IAAI;QACVE,OAAO,EAAE,KAAK;QACdD,KAAK,EAAEe,QAAQ,CAACI,MAAM,CAAC,CAAC,CAAC,CAACE;MAC9B,CAAC,CAAC;IACN;EAEJ,CAAC;EAED5B,SAAS,CAAC,MAAM;IACZ,IAAGe,KAAK,EAAE;MACNM,SAAS,CAAC,CAAC;IACf,CAAC,MACI;MACDP,OAAO,CAAC;QACJR,IAAI,EAAE,IAAI;QACVE,OAAO,EAAE,KAAK;QACdD,KAAK,EAAE;MACX,CAAC,CAAC;IACN;EAEJ,CAAC,EAAE,EAAE,CAAC;EAEN,oBAAOH,OAAA,CAACC,WAAW,CAACwB,QAAQ;IAACC,KAAK,EAAE,CAACjB,IAAI,EAAEC,OAAO,CAAE;IAAAF,QAAA,EAC/CA;EAAQ;IAAAmB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACS,CAAC;AAC3B,CAAC;AAACvB,EAAA,CArDIF,YAAY;AAAA0B,EAAA,GAAZ1B,YAAY;AAuDlB,SAAQJ,WAAW,EAAEI,YAAY;AAAE,IAAA0B,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}